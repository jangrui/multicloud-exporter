# 统一 NLB 指标映射关系（Aliyun / Tencent）
# 说明：canonical 指代统一后的 `nlb_*` 名称；各云平台原始指标在 providers 下声明，并给出单位与查询层的缩放建议。

prefix: nlb
namespaces:
  aliyun: acs_nlb
  aws: AWS/NetworkELB

canonical:
  # 连接类指标
  active_connection:
    description: "活跃连接数"
    aliyun:
      metric: InstanceActiveConnection
      dimensions:
        - userId
        - instanceId
      unit: count
    aws:
      metric: ActiveFlowCount
      dimensions:
        - LoadBalancer
      unit: count
  new_connection:
    description: "新建连接数"
    aliyun:
      metric: InstanceNewConnection
      dimensions:
        - userId
        - instanceId
      unit: count/s
    aws:
      metric: NewFlowCount
      dimensions:
        - LoadBalancer
      unit: count
  dropped_connection:
    description: "丢弃连接数"
    aliyun:
      metric: DropConnection
      dimensions:
        - userId
        - instanceId
        - zone
      unit: count/s
    # AWS NLB has TCP_Client_Reset_Count etc., but not a single "Dropped Connection" metric.
    # Skipping for AWS.

  # 流量类指标
  traffic_rx_bps:
    description: "入网流量"
    aliyun:
      metric: InstanceTrafficRX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
      scale: 1
    aws:
      metric: ProcessedBytes
      dimensions:
        - LoadBalancer
      unit: byte
      # AWS provides total ProcessedBytes (sum).
  traffic_tx_bps:
    description: "出网流量"
    aliyun:
      metric: InstanceTrafficTX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
      scale: 1
    # AWS ProcessedBytes is total. Skipping TX to avoid double counting or confusion.

  drop_packet_rx:
    description: "入网丢包速率"
    aliyun:
      metric: InstanceDropPacketRX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  drop_packet_tx:
    description: "出网丢包速率"
    aliyun:
      metric: InstanceDropPacketTX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  
  # 包转发类
  packet_rx:
    description: "入网包速率"
    aliyun:
      metric: InstancePacketRX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  packet_tx:
    description: "出网包速率"
    aliyun:
      metric: InstancePacketTX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  
  listener_healthy_server_count:
    description: "监听器健康后端数"
    aliyun:
      metric: ListenerHeathyServerCount
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count
  listener_unhealthy_server_count:
    description: "监听器异常后端数"
    aliyun:
      metric: ListenerUnhealthyServerCount
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count
  listener_packet_rx:
    description: "监听器入网包速率"
    aliyun:
      metric: ListenerPacketRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_packet_tx:
    description: "监听器出网包速率"
    aliyun:
      metric: ListenerPacketTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_drop_packet_rx:
    description: "监听器入网丢包速率"
    aliyun:
      metric: DropPacketRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_drop_packet_tx:
    description: "监听器出网丢包速率"
    aliyun:
      metric: DropPacketTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_drop_traffic_rx_bps:
    description: "监听器入网丢弃流量"
    aliyun:
      metric: DropTrafficRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: bit/s
  listener_drop_traffic_tx_bps:
    description: "监听器出网丢弃流量"
    aliyun:
      metric: DropTrafficTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: bit/s
  
  instance_inactive_connection:
    description: "实例非活跃连接数"
    aliyun:
      metric: InstanceInactiveConnection
      dimensions:
        - userId
        - instanceId
      unit: count
  instance_max_connection:
    description: "实例最大连接数"
    aliyun:
      metric: InstanceMaxConnection
      dimensions:
        - userId
        - instanceId
      unit: count
  instance_drop_connection:
    description: "实例丢弃连接数"
    aliyun:
      metric: InstanceDropConnection
      dimensions:
        - userId
        - instanceId
      unit: count/s
  instance_drop_traffic_rx_bps:
    description: "实例入网丢弃流量"
    aliyun:
      metric: InstanceDropTrafficRX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
  instance_drop_traffic_tx_bps:
    description: "实例出网丢弃流量"
    aliyun:
      metric: InstanceDropTrafficTX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
  
  vip_active_connection:
    description: "VIP 活跃连接数"
    aliyun:
      metric: VipActiveConnection
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count
  vip_client_reset_packet:
    description: "VIP 客户端复位包数"
    aliyun:
      metric: VipClientResetPacket
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_connection:
    description: "VIP 丢弃连接数"
    aliyun:
      metric: VipDropConnection
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_packet_rx:
    description: "VIP 入网丢包速率"
    aliyun:
      metric: VipDropPacketRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_packet_tx:
    description: "VIP 出网丢包速率"
    aliyun:
      metric: VipDropPacketTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_traffic_rx_bps:
    description: "VIP 入网丢弃流量"
    aliyun:
      metric: VipDropTrafficRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_drop_traffic_tx_bps:
    description: "VIP 出网丢弃流量"
    aliyun:
      metric: VipDropTrafficTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_packet_rx:
    description: "VIP 入网包速率"
    aliyun:
      metric: VipPacketRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_packet_tx:
    description: "VIP 出网包速率"
    aliyun:
      metric: VipPacketTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_traffic_rx_bps:
    description: "VIP 入网流量"
    aliyun:
      metric: VipTrafficRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_traffic_tx_bps:
    description: "VIP 出网流量"
    aliyun:
      metric: VipTrafficTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
# 实例带宽利用率 (Aliyun NLB 未直接提供百分比，需计算或使用 BandwidthUtilization 如果存在? Grep 未显示)
# 排序整理：2025-12-15；修改者：@jangrui；规则：按实例/VIP 的连接、流量、包速率、丢包等类别分组展示（仅调整可读性，不改变键与字段）
 

# 阿里云特有指标
 

 
