prefix: nlb
namespaces:
  aliyun: acs_nlb
  aws: AWS/NetworkELB

canonical:
  # ========================================
  # 全映射指标（2 家云厂商）
  # ========================================
  active_connection:
    description: "活跃连接数"
    aliyun:
      metric: InstanceActiveConnection
      dimensions:
        - userId
        - instanceId
      unit: count
    aws:
      metric: ActiveFlowCount
      dimensions:
        - LoadBalancer
      unit: count
  listener_healthy_server_count:
    description: "监听器健康后端数"
    aliyun:
      metric: ListenerHeathyServerCount
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count
    aws:
      metric: HealthyHostCount
      dimensions:
        - LoadBalancer
        - TargetGroup
      unit: count
  listener_unhealthy_server_count:
    description: "监听器异常后端数"
    aliyun:
      metric: ListenerUnhealthyServerCount
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count
    aws:
      metric: UnHealthyHostCount
      dimensions:
        - LoadBalancer
        - TargetGroup
      unit: count
  new_connection:
    description: "新建连接数"
    aliyun:
      metric: InstanceNewConnection
      dimensions:
        - userId
        - instanceId
      unit: count/s
    aws:
      metric: NewFlowCount
      dimensions:
        - LoadBalancer
      unit: count

  # ========================================
  # 单独指标（阿里云专用）
  # ========================================
  dropped_connection:
    description: "丢弃连接数"
    aliyun:
      metric: DropConnection
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  drop_packet_rx:
    description: "入网丢包速率"
    aliyun:
      metric: InstanceDropPacketRX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  drop_packet_tx:
    description: "出网丢包速率"
    aliyun:
      metric: InstanceDropPacketTX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  instance_drop_connection:
    description: "实例丢弃连接数"
    aliyun:
      metric: InstanceDropConnection
      dimensions:
        - userId
        - instanceId
      unit: count/s
  instance_drop_traffic_rx_bps:
    description: "实例入网丢弃流量"
    aliyun:
      metric: InstanceDropTrafficRX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
  instance_drop_traffic_tx_bps:
    description: "实例出网丢弃流量"
    aliyun:
      metric: InstanceDropTrafficTX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
  instance_inactive_connection:
    description: "实例非活跃连接数"
    aliyun:
      metric: InstanceInactiveConnection
      dimensions:
        - userId
        - instanceId
      unit: count
  instance_max_connection:
    description: "实例最大连接数"
    aliyun:
      metric: InstanceMaxConnection
      dimensions:
        - userId
        - instanceId
      unit: count
  listener_drop_packet_rx:
    description: "监听器入网丢包速率"
    aliyun:
      metric: DropPacketRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_drop_packet_tx:
    description: "监听器出网丢包速率"
    aliyun:
      metric: DropPacketTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_drop_traffic_rx_bps:
    description: "监听器入网丢弃流量"
    aliyun:
      metric: DropTrafficRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: bit/s
  listener_drop_traffic_tx_bps:
    description: "监听器出网丢弃流量"
    aliyun:
      metric: DropTrafficTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: bit/s
  listener_packet_rx:
    description: "监听器入网包速率"
    aliyun:
      metric: ListenerPacketRX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  listener_packet_tx:
    description: "监听器出网包速率"
    aliyun:
      metric: ListenerPacketTX
      dimensions:
        - userId
        - instanceId
        - listenerPort
        - listenerProtocol
      unit: count/s
  packet_rx:
    description: "入网包速率"
    aliyun:
      metric: InstancePacketRX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  packet_tx:
    description: "出网包速率"
    aliyun:
      metric: InstancePacketTX
      dimensions:
        - userId
        - instanceId
      unit: count/s
      scale: 1
  traffic_rx_bps:
    description: "入网流量"
    aliyun:
      metric: InstanceTrafficRX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
      scale: 1
  traffic_tx_bps:
    description: "出网流量"
    aliyun:
      metric: InstanceTrafficTX
      dimensions:
        - userId
        - instanceId
      unit: bit/s
      scale: 1
  vip_active_connection:
    description: "VIP 活跃连接数"
    aliyun:
      metric: VipActiveConnection
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count
  vip_client_reset_packet:
    description: "VIP 客户端复位包数"
    aliyun:
      metric: VipClientResetPacket
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_connection:
    description: "VIP 丢弃连接数"
    aliyun:
      metric: VipDropConnection
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_packet_rx:
    description: "VIP 入网丢包速率"
    aliyun:
      metric: VipDropPacketRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_packet_tx:
    description: "VIP 出网丢包速率"
    aliyun:
      metric: VipDropPacketTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_drop_traffic_rx_bps:
    description: "VIP 入网丢弃流量"
    aliyun:
      metric: VipDropTrafficRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_drop_traffic_tx_bps:
    description: "VIP 出网丢弃流量"
    aliyun:
      metric: VipDropTrafficTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_packet_rx:
    description: "VIP 入网包速率"
    aliyun:
      metric: VipPacketRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_packet_tx:
    description: "VIP 出网包速率"
    aliyun:
      metric: VipPacketTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: count/s
  vip_traffic_rx_bps:
    description: "VIP 入网流量"
    aliyun:
      metric: VipTrafficRX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s
  vip_traffic_tx_bps:
    description: "VIP 出网流量"
    aliyun:
      metric: VipTrafficTX
      dimensions:
        - userId
        - instanceId
        - vip
      unit: bit/s

  # ========================================
  # 单独指标（AWS 专用）
  # ========================================
  active_flow_count_tcp:
    description: "TCP 活跃连接数"
    aws:
      metric: ActiveFlowCount_TCP
      dimensions:
        - LoadBalancer
      unit: count
  active_flow_count_tls:
    description: "TLS 活跃连接数"
    aws:
      metric: ActiveFlowCount_TLS
      dimensions:
        - LoadBalancer
      unit: count
  active_flow_count_udp:
    description: "UDP 活跃连接数"
    aws:
      metric: ActiveFlowCount_UDP
      dimensions:
        - LoadBalancer
      unit: count
  client_reset_count:
    description: "客户端复位连接数"
    aws:
      metric: ClientResetCount
      dimensions:
        - LoadBalancer
      unit: count
  consumed_lc_us:
    description: "消耗的 LCUs 数量"
    aws:
      metric: ConsumedLCUs
      dimensions:
        - LoadBalancer
      unit: count
  new_flow_count_tcp:
    description: "TCP 新建连接数"
    aws:
      metric: NewFlowCount_TCP
      dimensions:
        - LoadBalancer
      unit: count
  new_flow_count_tls:
    description: "TLS 新建连接数"
    aws:
      metric: NewFlowCount_TLS
      dimensions:
        - LoadBalancer
      unit: count
  new_flow_count_udp:
    description: "UDP 新建连接数"
    aws:
      metric: NewFlowCount_UDP
      dimensions:
        - LoadBalancer
      unit: count
  port_allocation_failure_count:
    description: "端口分配失败数"
    aws:
      metric: PortAllocationFailureCount
      dimensions:
        - LoadBalancer
      unit: count
  processed_bytes:
    description: "处理字节数"
    aws:
      metric: ProcessedBytes
      dimensions:
        - LoadBalancer
      unit: Bytes
  tcp_client_reset_count:
    description: "TCP 客户端复位连接数"
    aws:
      metric: TCPClientResetCount
      dimensions:
        - LoadBalancer
      unit: count
  tcp_elb_reset_count:
    description: "TCP ELB 复位连接数"
    aws:
      metric: TCP_ELB_Reset_Count
      dimensions:
        - LoadBalancer
      unit: count
