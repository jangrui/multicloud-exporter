{
  "title": "LB 统一查询（多云）",
  "tags": ["network", "lb", "mce", "unified"],
  "timezone": "browser",
  "schemaVersion": 41,
  "version": 1,
  "refresh": "30s",
  "uid": "lb-unified",
  "editable": true,
  "panels": [
    {"type": "timeseries", "title": "入方向带宽", "id": 1, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 0, "y": 0}, "fieldConfig": {"defaults": {"unit": "bps"}, "overrides": []}, "targets": [{"expr": "lb_traffic_rx_bps{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 入带宽", "refId": "A"}]},
    {"type": "timeseries", "title": "出方向带宽", "id": 2, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 8, "y": 0}, "fieldConfig": {"defaults": {"unit": "bps"}, "overrides": []}, "targets": [{"expr": "lb_traffic_tx_bps{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 出带宽", "refId": "A"}]},
    {"type": "timeseries", "title": "入方向包速率", "id": 3, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 0, "y": 7}, "fieldConfig": {"defaults": {"unit": "pps"}, "overrides": []}, "targets": [{"expr": "lb_packet_rx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 入包", "refId": "A"}]},
    {"type": "timeseries", "title": "出方向包速率", "id": 4, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 8, "y": 7}, "fieldConfig": {"defaults": {"unit": "pps"}, "overrides": []}, "targets": [{"expr": "lb_packet_tx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 出包", "refId": "A"}]},
    {"type": "timeseries", "title": "入/出方向丢包", "id": 5, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 0, "y": 14}, "fieldConfig": {"defaults": {"unit": "pps"}, "overrides": []}, "targets": [
      {"expr": "lb_drop_packet_rx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 入向丢包", "refId": "A"},
      {"expr": "lb_drop_packet_tx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 出向丢包", "refId": "B"}
    ]},
    {"type": "timeseries", "title": "七层 QPS & RT（阿里云）", "id": 6, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 8, "y": 14}, "fieldConfig": {"defaults": {"unit": "ops"}, "overrides": []}, "targets": [
      {"expr": "lb_qps{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - QPS", "refId": "A"},
      {"expr": "lb_rt{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - RT", "refId": "B"}
    ]},
    {"type": "timeseries", "title": "状态码分布（阿里云）", "id": 7, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 16, "x": 0, "y": 21}, "fieldConfig": {"defaults": {"unit": "ops"}, "overrides": []}, "targets": [
      {"expr": "lb_status_code_2xx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 2xx", "refId": "A"},
      {"expr": "lb_status_code_3xx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 3xx", "refId": "B"},
      {"expr": "lb_status_code_4xx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 4xx", "refId": "C"},
      {"expr": "lb_status_code_5xx{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 5xx", "refId": "D"}
    ]},
    {"type": "timeseries", "title": "后端异常实例数（阿里云）", "id": 8, "pluginVersion": "11.6.1", "gridPos": {"h": 7, "w": 8, "x": 0, "y": 28}, "fieldConfig": {"defaults": {"unit": "short"}, "overrides": []}, "targets": [{"expr": "lb_unhealthy_server_count{cloud_provider=~\"$cloud_provider\", account_id=~\"$account_id\", region=~\"$region\", resource_id=~\"$resource_id\", code_name=~\"$code_name\"}", "legendFormat": "{{resource_id}} - 异常服务器", "refId": "A"}]}
  ],
  "templating": {
    "list": [
      {"type": "datasource", "name": "datasource", "label": "数据源", "query": "prometheus", "refresh": 1, "current": {"text": "default", "value": "prometheus"}},
      {"type": "query", "name": "cloud_provider", "label": "云厂商", "datasource": {"type": "prometheus", "uid": "$datasource"}, "definition": "label_values(lb_traffic_rx_bps,cloud_provider)", "query": "label_values(lb_traffic_rx_bps,cloud_provider)", "refresh": 1, "includeAll": true, "allValue": ".*"},
      {"type": "query", "name": "account_id", "label": "账号", "datasource": {"type": "prometheus", "uid": "$datasource"}, "definition": "label_values(lb_traffic_rx_bps,account_id)", "query": "label_values(lb_traffic_rx_bps,account_id)", "refresh": 1, "includeAll": true, "allValue": ".*"},
      {"type": "query", "name": "region", "label": "地域", "datasource": {"type": "prometheus", "uid": "$datasource"}, "definition": "label_values(lb_traffic_rx_bps,region)", "query": "label_values(lb_traffic_rx_bps,region)", "refresh": 1, "includeAll": true, "allValue": ".*"},
      {"type": "query", "name": "resource_id", "label": "资源ID", "datasource": {"type": "prometheus", "uid": "$datasource"}, "definition": "label_values(lb_traffic_rx_bps,resource_id)", "query": "label_values(lb_traffic_rx_bps,resource_id)", "refresh": 1, "includeAll": true, "allValue": ".*"},
      {"type": "query", "name": "code_name", "label": "业务名", "datasource": {"type": "prometheus", "uid": "$datasource"}, "definition": "label_values(lb_traffic_rx_bps,code_name)", "query": "label_values(lb_traffic_rx_bps,code_name)", "refresh": 1, "includeAll": true, "allValue": ".*"}
    ]
  }
}
